<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>班级积分系统</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Comic Sans MS', 'Marker Felt', '华文圆体', sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        header {
            text-align: center;
            margin-bottom: 30px;
            padding: 20px;
            background: linear-gradient(135deg, #ff9a9e 0%, #fad0c4 100%);
            border-radius: 20px;
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
        }
        
        h1 {
            color: #ff6b6b;
            font-size: 2.8rem;
            margin-bottom: 15px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
        }
        
        .date {
            font-size: 1.2rem;
            color: #5a67d8;
            margin-bottom: 10px;
        }
        
        .controls {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }
        
        .btn {
            padding: 12px 25px;
            border: none;
            border-radius: 50px;
            font-size: 1.1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #6a11cb 0%, #2575fc 100%);
            color: white;
        }
        
        .btn-success {
            background: linear-gradient(135deg, #42e695 0%, #3bb2b8 100%);
            color: white;
        }
        
        .btn-danger {
            background: linear-gradient(135deg, #ff758c 0%, #ff7eb3 100%);
            color: white;
        }
        
        .btn-warning {
            background: linear-gradient(135deg, #ffcc67 0%, #ff9966 100%);
            color: white;
        }
        
        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.15);
        }
        
        .btn:active {
            transform: translateY(0);
        }
        
        .batch-control {
            background: white;
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 30px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            text-align: center;
        }
        
        .batch-control h2 {
            color: #ff6b6b;
            margin-bottom: 15px;
        }
        
        .batch-input {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-bottom: 15px;
            flex-wrap: wrap;
        }
        
        input {
            padding: 10px 15px;
            border: 2px solid #d9d9d9;
            border-radius: 50px;
            font-size: 1rem;
            width: 100px;
            text-align: center;
        }
        
        .student-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .student-card {
            background: white;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s ease;
            text-align: center;
            position: relative;
            overflow: hidden;
        }
        
        .student-card:hover {
            transform: translateY(-5px);
        }
        
        .student-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 8px;
            background: linear-gradient(90deg, #ff9a9e, #fad0c4, #a18cd1, #fbc2eb);
            border-radius: 15px 15px 0 0;
        }
        
        .student-id {
            position: absolute;
            top: 15px;
            left: 15px;
            background: #ff6b6b;
            color: white;
            width: 36px;
            height: 36px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }
        
        .student-name {
            margin-top: 10px;
            font-size: 1.2rem;
            color: #444;
        }
        
        .points {
            font-size: 2.2rem;
            font-weight: bold;
            color: #6a11cb;
            margin: 15px 0;
        }
        
        .coins {
            font-size: 1.5rem;
            color: #ff9966;
            margin-bottom: 20px;
        }
        
        .coin-icon {
            color: gold;
            margin-right: 5px;
        }
        
        .actions {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-bottom: 15px;
        }
        
        .action-btn {
            padding: 8px 15px;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.9rem;
        }
        
        .add-btn {
            background: #42e695;
            color: white;
        }
        
        .subtract-btn {
            background: #ff758c;
            color: white;
        }
        
        .exchange-btn {
            background: #ffcc67;
            color: white;
            padding: 8px 20px;
            width: 100%;
        }
        
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }
        
        .modal-content {
            background: white;
            padding: 30px;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            max-width: 500px;
            width: 90%;
            text-align: center;
        }
        
        .modal h2 {
            color: #ff6b6b;
            margin-bottom: 20px;
        }
        
        .ranking-list {
            list-style: none;
            max-height: 400px;
            overflow-y: auto;
            margin: 20px 0;
            padding: 0;
        }
        
        .ranking-item {
            display: flex;
            justify-content: space-between;
            padding: 12px 20px;
            border-bottom: 1px solid #eee;
            font-size: 1.1rem;
        }
        
        .ranking-item:nth-child(1) {
            background: linear-gradient(135deg, #fff6a8 0%, #ffd966 100%);
            border-radius: 10px;
            font-weight: bold;
        }
        
        .ranking-item:nth-child(2) {
            background: #f8f9fa;
        }
        
        .ranking-item:nth-child(3) {
            background: #f8f9fa;
        }
        
        .close-btn {
            padding: 10px 25px;
            background: #6a11cb;
            color: white;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            font-size: 1rem;
            margin-top: 15px;
        }
        
        footer {
            text-align: center;
            margin-top: 40px;
            color: #777;
            font-size: 0.9rem;
        }
        
        @media (max-width: 768px) {
            .student-grid {
                grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
            }
            
            .controls {
                flex-direction: column;
                align-items: center;
            }
            
            .btn {
                width: 80%;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>班级积分系统</h1>
            <div class="date">2025年9月12日</div>
            <p>管理班级积分和兑换币，奖励优秀学生</p>
        </header>
        
        <div class="controls">
            <button class="btn btn-primary" id="rankBtn">
                <i class="fas fa-trophy"></i> 积分排行榜
            </button>
            <button class="btn btn-success" id="saveBtn">
                <i class="fas fa-save"></i> 保存数据
            </button>
            <button class="btn btn-warning" id="resetBtn">
                <i class="fas fa-redo"></i> 重置数据
            </button>
        </div>
        
        <div class="batch-control">
            <h2><i class="fas fa-users"></i> 批量操作</h2>
            <div class="batch-input">
                <input type="number" id="batchPoints" placeholder="积分数量" min="1">
                <button class="btn btn-success" id="batchAdd">
                    <i class="fas fa-plus-circle"></i> 全班加分
                </button>
                <button class="btn btn-danger" id="batchSubtract">
                    <i class="fas fa-minus-circle"></i> 全班减分
                </button>
            </div>
        </div>
        
        <div class="student-grid" id="studentGrid">
            <!-- 学生卡片将通过JavaScript动态生成 -->
        </div>
        
        <footer>
            <p>班级积分系统 &copy; 2025 - 设计给最棒的班主任和学生们！</p>
        </footer>
    </div>
    
    <!-- 排行榜模态框 -->
    <div class="modal" id="rankingModal">
        <div class="modal-content">
            <h2><i class="fas fa-trophy"></i> 积分排行榜</h2>
            <ul class="ranking-list" id="rankingList">
                <!-- 排行榜内容将通过JavaScript动态生成 -->
            </ul>
            <button class="close-btn" id="closeRanking">关闭</button>
        </div>
    </div>

    <script>
        // 初始化学生数据
        let students = JSON.parse(localStorage.getItem('classPoints')) || [];
        
        // 如果本地存储中没有数据，初始化32个学生的数据
        if (students.length === 0) {
            for (let i = 1; i <= 32; i++) {
                students.push({
                    id: i,
                    name: `学生${i}`,
                    points: 0,
                    coins: 0
                });
            }
            saveData();
        }
        
        // 生成学生卡片
        function renderStudents() {
            const grid = document.getElementById('studentGrid');
            grid.innerHTML = '';
            
            students.forEach(student => {
                const card = document.createElement('div');
                card.className = 'student-card';
                card.innerHTML = `
                    <div class="student-id">${student.id}</div>
                    <div class="student-name">${student.name}</div>
                    <div class="points">${student.points} 分</div>
                    <div class="coins"><i class="fas fa-coin coin-icon"></i> ${student.coins} 币</div>
                    <div class="actions">
                        <button class="action-btn add-btn" onclick="addPoints(${student.id}, 1)">+1</button>
                        <button class="action-btn add-btn" onclick="addPoints(${student.id}, 5)">+5</button>
                        <button class="action-btn subtract-btn" onclick="subtractPoints(${student.id}, 1)">-1</button>
                        <button class="action-btn subtract-btn" onclick="subtractPoints(${student.id}, 5)">-5</button>
                    </div>
                    <button class="exchange-btn" onclick="exchangeCoins(${student.id})">
                        <i class="fas fa-exchange-alt"></i> 兑换奖励
                    </button>
                `;
                grid.appendChild(card);
            });
        }
        
        // 加分函数
        function addPoints(studentId, points) {
            const student = students.find(s => s.id === studentId);
            if (student) {
                student.points += points;
                student.coins += points;
                saveData();
                renderStudents();
            }
        }
        
        // 减分函数
        function subtractPoints(studentId, points) {
            const student = students.find(s => s.id === studentId);
            if (student) {
                student.points = Math.max(0, student.points - points);
                student.coins = Math.max(0, student.coins - points);
                saveData();
                renderStudents();
            }
        }
        
        // 兑换奖励
        function exchangeCoins(studentId) {
            const student = students.find(s => s.id === studentId);
            if (student) {
                const coinsToExchange = parseInt(prompt(`${student.name}，您有 ${student.coins} 兑换币，要兑换多少？`, "10"));
                
                if (!isNaN(coinsToExchange) && coinsToExchange > 0) {
                    if (coinsToExchange <= student.coins) {
                        student.coins -= coinsToExchange;
                        alert(`兑换成功！${student.name}消耗了 ${coinsToExchange} 兑换币`);
                        saveData();
                        renderStudents();
                    } else {
                        alert("兑换币不足！");
                    }
                }
            }
        }
        
        // 批量加分
        function batchAddPoints() {
            const pointsInput = document.getElementById('batchPoints');
            const points = parseInt(pointsInput.value);
            
            if (isNaN(points) || points <= 0) {
                alert("请输入有效的积分数量！");
                return;
            }
            
            if (confirm(`确定要给全班每人加 ${points} 分吗？`)) {
                students.forEach(student => {
                    student.points += points;
                    student.coins += points;
                });
                
                saveData();
                renderStudents();
                pointsInput.value = '';
            }
        }
        
        // 批量减分
        function batchSubtractPoints() {
            const pointsInput = document.getElementById('batchPoints');
            const points = parseInt(pointsInput.value);
            
            if (isNaN(points) || points <= 0) {
                alert("请输入有效的积分数量！");
                return;
            }
            
            if (confirm(`确定要给全班每人减 ${points} 分吗？`)) {
                students.forEach(student => {
                    student.points = Math.max(0, student.points - points);
                    student.coins = Math.max(0, student.coins - points);
                });
                
                saveData();
                renderStudents();
                pointsInput.value = '';
            }
        }
        
        // 显示排行榜
        function showRanking() {
            const rankingList = document.getElementById('rankingList');
            rankingList.innerHTML = '';
            
            // 按积分排序
            const sortedStudents = [...students].sort((a, b) => b.points - a.points);
            
            sortedStudents.forEach((student, index) => {
                const item = document.createElement('li');
                item.className = 'ranking-item';
                item.innerHTML = `
                    <span>${index + 1}. ${student.name}</span>
                    <span>${student.points} 分</span>
                `;
                rankingList.appendChild(item);
            });
            
            document.getElementById('rankingModal').style.display = 'flex';
        }
        
        // 保存数据到localStorage
        function saveData() {
            localStorage.setItem('classPoints', JSON.stringify(students));
            alert('数据已保存！');
        }
        
        // 重置数据
        function resetData() {
            if (confirm('确定要重置所有积分和兑换币吗？此操作不可撤销！')) {
                students.forEach(student => {
                    student.points = 0;
                    student.coins = 0;
                });
                saveData();
                renderStudents();
            }
        }
        
        // 关闭模态框
        function closeModal() {
            document.getElementById('rankingModal').style.display = 'none';
        }
        
        // 事件监听
        document.getElementById('rankBtn').addEventListener('click', showRanking);
        document.getElementById('saveBtn').addEventListener('click', saveData);
        document.getElementById('resetBtn').addEventListener('click', resetData);
        document.getElementById('batchAdd').addEventListener('click', batchAddPoints);
        document.getElementById('batchSubtract').addEventListener('click', batchSubtractPoints);
        document.getElementById('closeRanking').addEventListener('click', closeModal);
        
        // 初始化页面
        renderStudents();
    </script>
</body>
</html>